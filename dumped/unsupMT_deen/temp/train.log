INFO - 07/11/22 20:40:51 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 20:40:51 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 20:40:52 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 20:40:52 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 20:41:00 - 0:00:08 - ============ Monolingual data (de)
INFO - 07/11/22 20:41:00 - 0:00:08 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/11/22 20:41:10 - 0:00:18 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/11/22 20:41:10 - 0:00:18 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/11/22 20:41:25 - 0:00:33 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/11/22 20:41:25 - 0:00:33 - ============ Monolingual data (en)
INFO - 07/11/22 20:41:25 - 0:00:33 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/11/22 20:41:26 - 0:00:35 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/11/22 20:41:26 - 0:00:35 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/11/22 20:41:27 - 0:00:36 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/11/22 20:41:28 - 0:00:36 - ============ Parallel data (de-en)
INFO - 07/11/22 20:41:28 - 0:00:36 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/11/22 20:45:58 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 20:45:58 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 20:45:58 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 20:45:58 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 20:46:01 - 0:00:04 - ============ Monolingual data (de)
INFO - 07/11/22 20:46:01 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/11/22 20:46:03 - 0:00:05 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/11/22 20:46:03 - 0:00:05 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/11/22 20:46:04 - 0:00:06 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/11/22 20:46:04 - 0:00:07 - ============ Monolingual data (en)
INFO - 07/11/22 20:46:04 - 0:00:07 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/11/22 20:46:05 - 0:00:07 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/11/22 20:46:05 - 0:00:08 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/11/22 20:46:07 - 0:00:10 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/11/22 20:46:07 - 0:00:10 - ============ Parallel data (de-en)
INFO - 07/11/22 20:46:07 - 0:00:10 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/11/22 20:58:57 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 20:58:57 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 20:58:57 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 20:58:57 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 20:59:10 - 0:00:13 - ============ Monolingual data (de)
INFO - 07/11/22 20:59:10 - 0:00:13 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/11/22 20:59:13 - 0:00:15 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/11/22 20:59:13 - 0:00:15 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/11/22 20:59:14 - 0:00:17 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/11/22 20:59:14 - 0:00:17 - ============ Monolingual data (en)
INFO - 07/11/22 20:59:14 - 0:00:17 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/11/22 21:05:58 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 21:05:58 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 21:05:58 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 21:05:58 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 21:06:51 - 0:00:53 - ============ Monolingual data (de)
INFO - 07/11/22 21:06:51 - 0:00:53 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/11/22 21:08:13 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 21:08:13 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 21:08:13 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 21:08:13 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 21:08:39 - 0:00:26 - ============ Monolingual data (de)
INFO - 07/11/22 21:08:39 - 0:00:26 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/11/22 21:16:04 - 0:00:00 - ============ Initialized logger ============
INFO - 07/11/22 21:16:04 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/11/22 21:16:04 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/11/22 21:16:04 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/11/22 21:17:44 - 0:01:40 - ============ Monolingual data (de)
INFO - 07/11/22 21:17:44 - 0:01:40 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 10:50:19 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 10:50:19 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 10:50:19 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 10:50:19 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 10:50:28 - 0:00:10 - ============ Monolingual data (de)
INFO - 07/12/22 10:50:28 - 0:00:10 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 11:14:12 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 11:14:12 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 11:14:12 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 11:14:12 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 11:14:12 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/12/22 11:14:12 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 17:14:24 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 17:14:24 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 17:14:24 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 17:14:24 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 17:14:24 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/12/22 17:14:24 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 17:14:30 - 0:00:06 - test torch.load
INFO - 07/12/22 17:14:30 - 0:00:06 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/12/22 17:14:30 - 0:00:06 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/12/22 17:14:31 - 0:00:07 - test torch.load
INFO - 07/12/22 17:14:31 - 0:00:07 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/12/22 17:14:31 - 0:00:07 - ============ Monolingual data (en)
INFO - 07/12/22 17:14:31 - 0:00:07 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/12/22 17:14:33 - 0:00:09 - test torch.load
INFO - 07/12/22 17:14:33 - 0:00:09 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/12/22 17:14:33 - 0:00:09 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/12/22 17:14:34 - 0:00:10 - test torch.load
INFO - 07/12/22 17:14:34 - 0:00:10 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/12/22 17:14:34 - 0:00:10 - ============ Parallel data (de-en)
INFO - 07/12/22 17:14:34 - 0:00:10 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/12/22 17:14:35 - 0:00:11 - test torch.load
INFO - 07/12/22 17:14:35 - 0:00:11 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/12/22 17:14:35 - 0:00:11 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/12/22 17:14:39 - 0:00:15 - test torch.load
INFO - 07/12/22 17:14:39 - 0:00:15 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/12/22 17:14:40 - 0:00:16 - Removed 0 empty sentences.

INFO - 07/12/22 17:14:40 - 0:00:16 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/12/22 17:14:41 - 0:00:17 - test torch.load
INFO - 07/12/22 17:14:41 - 0:00:17 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 17:14:41 - 0:00:17 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/12/22 17:14:42 - 0:00:18 - test torch.load
INFO - 07/12/22 17:14:42 - 0:00:18 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 17:14:43 - 0:00:19 - Removed 0 empty sentences.


INFO - 07/12/22 17:14:43 - 0:00:19 - ============ Data summary
INFO - 07/12/22 17:14:43 - 0:00:19 - Monolingual data   - valid -           de:      3000
INFO - 07/12/22 17:14:43 - 0:00:19 - Monolingual data   -  test -           de:      2999
INFO - 07/12/22 17:14:43 - 0:00:19 - Monolingual data   - valid -           en:      3000
INFO - 07/12/22 17:14:43 - 0:00:19 - Monolingual data   -  test -           en:      2999
INFO - 07/12/22 17:14:43 - 0:00:19 - Parallel data      - valid -        de-en:      3000
INFO - 07/12/22 17:14:43 - 0:00:19 - Parallel data      -  test -        de-en:      2999

INFO - 07/12/22 17:14:46 - 0:00:22 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/12/22 23:15:51 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 23:15:51 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 23:15:51 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 23:15:51 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 23:15:51 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/12/22 23:15:51 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/12/22 23:16:14 - 0:00:23 - test torch.load
INFO - 07/12/22 23:16:14 - 0:00:23 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:16:15 - 0:00:24 - Removed 0 empty sentences.
INFO - 07/12/22 23:16:15 - 0:00:24 - Removed 6354 too long sentences.

INFO - 07/12/22 23:16:15 - 0:00:24 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 23:16:15 - 0:00:24 - test torch.load
INFO - 07/12/22 23:16:15 - 0:00:24 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/12/22 23:16:15 - 0:00:24 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/12/22 23:16:15 - 0:00:24 - test torch.load
INFO - 07/12/22 23:16:15 - 0:00:24 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/12/22 23:16:16 - 0:00:25 - ============ Monolingual data (en)
INFO - 07/12/22 23:16:16 - 0:00:25 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/12/22 23:16:21 - 0:00:30 - test torch.load
INFO - 07/12/22 23:16:21 - 0:00:30 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:16:23 - 0:00:32 - Removed 0 empty sentences.
INFO - 07/12/22 23:16:23 - 0:00:32 - Removed 13059 too long sentences.

INFO - 07/12/22 23:16:23 - 0:00:32 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/12/22 23:16:23 - 0:00:32 - test torch.load
INFO - 07/12/22 23:16:23 - 0:00:32 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/12/22 23:16:23 - 0:00:32 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/12/22 23:16:24 - 0:00:32 - test torch.load
INFO - 07/12/22 23:16:24 - 0:00:32 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/12/22 23:16:24 - 0:00:33 - ============ Parallel data (de-en)
INFO - 07/12/22 23:16:24 - 0:00:33 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/12/22 23:16:24 - 0:00:33 - test torch.load
INFO - 07/12/22 23:16:24 - 0:00:33 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/12/22 23:16:24 - 0:00:33 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/12/22 23:16:24 - 0:00:33 - test torch.load
INFO - 07/12/22 23:16:24 - 0:00:33 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/12/22 23:16:25 - 0:00:34 - Removed 0 empty sentences.

INFO - 07/12/22 23:16:25 - 0:00:34 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/12/22 23:16:25 - 0:00:34 - test torch.load
INFO - 07/12/22 23:16:25 - 0:00:34 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:16:25 - 0:00:34 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/12/22 23:16:25 - 0:00:34 - test torch.load
INFO - 07/12/22 23:16:25 - 0:00:34 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:16:25 - 0:00:34 - Removed 0 empty sentences.


INFO - 07/12/22 23:16:25 - 0:00:34 - ============ Data summary
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   - train -           de:   5000000
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   - valid -           de:      3000
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   -  test -           de:      2999
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   - train -           en:   5000000
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   - valid -           en:      3000
INFO - 07/12/22 23:16:25 - 0:00:34 - Monolingual data   -  test -           en:      2999
INFO - 07/12/22 23:16:25 - 0:00:34 - Parallel data      - valid -        de-en:      3000
INFO - 07/12/22 23:16:25 - 0:00:34 - Parallel data      -  test -        de-en:      2999

INFO - 07/12/22 23:34:15 - 0:18:24 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/12/22 23:37:44 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 23:37:44 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin,F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin,F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 23:37:44 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 23:37:44 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin,F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 23:37:44 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/12/22 23:37:44 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/12/22 23:37:44 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:37:45 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/12/22 23:37:45 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/12/22 23:37:45 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 23:37:45 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/12/22 23:37:45 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/12/22 23:37:45 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/12/22 23:37:45 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/12/22 23:37:45 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/12/22 23:37:46 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:37:47 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/12/22 23:37:47 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/12/22 23:37:47 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/12/22 23:37:47 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/12/22 23:37:47 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/12/22 23:37:47 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/12/22 23:37:48 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/12/22 23:37:48 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/12/22 23:37:48 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/12/22 23:37:48 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/12/22 23:37:48 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/12/22 23:37:48 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/12/22 23:37:48 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/12/22 23:37:48 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:37:48 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/12/22 23:37:48 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:37:49 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/12/22 23:37:49 - 0:00:05 - ============ Data summary
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/12/22 23:37:49 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/12/22 23:37:49 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/12/22 23:37:49 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/12/22 23:38:14 - 0:00:30 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\pytorch_model.bin ...
INFO - 07/12/22 23:39:14 - 0:00:00 - ============ Initialized logger ============
INFO - 07/12/22 23:39:14 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/12/22 23:39:14 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/12/22 23:39:14 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/12/22 23:39:14 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/12/22 23:39:14 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/12/22 23:39:15 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:39:15 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/12/22 23:39:16 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/12/22 23:39:16 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/12/22 23:39:16 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/12/22 23:39:16 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/12/22 23:39:16 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/12/22 23:39:16 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/12/22 23:39:16 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/12/22 23:39:16 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:39:18 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/12/22 23:39:18 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/12/22 23:39:18 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/12/22 23:39:18 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/12/22 23:39:18 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/12/22 23:39:18 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/12/22 23:39:18 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/12/22 23:39:18 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/12/22 23:39:18 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/12/22 23:39:18 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/12/22 23:39:18 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/12/22 23:39:19 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/12/22 23:39:19 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/12/22 23:39:19 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:39:19 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/12/22 23:39:19 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/12/22 23:39:19 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/12/22 23:39:19 - 0:00:05 - ============ Data summary
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/12/22 23:39:19 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/12/22 23:39:19 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/12/22 23:39:19 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/12/22 23:39:27 - 0:00:12 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 00:00:07 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 00:00:07 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 00:00:07 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 00:00:07 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 00:00:07 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 00:00:07 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 00:00:07 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 00:00:08 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 00:00:08 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 00:00:08 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 00:00:08 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 00:00:08 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 00:00:08 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 00:00:09 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 00:00:09 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 00:00:09 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 00:00:10 - 0:00:04 - Removed 0 empty sentences.
INFO - 07/13/22 00:00:10 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 00:00:10 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 00:00:10 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 00:00:11 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 00:00:11 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 00:00:11 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 00:00:11 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 00:00:11 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 00:00:11 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 00:00:11 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 00:00:11 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 00:00:11 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 00:00:11 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 00:00:11 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 00:00:11 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 00:00:12 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 00:00:12 - 0:00:05 - ============ Data summary
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 00:00:12 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 00:00:12 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 00:00:12 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 00:00:17 - 0:00:11 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
DEBUG - 07/13/22 08:22:55 - 8:22:48 - S3PathHandler couldn't be imported. Either missing fb-only files, or boto3 module.
INFO - 07/13/22 08:29:14 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 08:29:14 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 08:29:14 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 08:29:14 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 08:29:14 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 08:29:14 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 08:29:19 - 0:00:05 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:29:20 - 0:00:06 - Removed 0 empty sentences.
INFO - 07/13/22 08:29:20 - 0:00:06 - Removed 6354 too long sentences.

INFO - 07/13/22 08:29:20 - 0:00:06 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 08:29:21 - 0:00:07 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 08:29:21 - 0:00:07 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 08:29:21 - 0:00:07 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 08:29:21 - 0:00:07 - ============ Monolingual data (en)
INFO - 07/13/22 08:29:21 - 0:00:07 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 08:29:27 - 0:00:13 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:29:28 - 0:00:14 - Removed 0 empty sentences.
INFO - 07/13/22 08:29:28 - 0:00:14 - Removed 13059 too long sentences.

INFO - 07/13/22 08:29:28 - 0:00:14 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 08:29:28 - 0:00:14 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 08:29:28 - 0:00:15 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 08:29:28 - 0:00:15 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 08:29:29 - 0:00:15 - ============ Parallel data (de-en)
INFO - 07/13/22 08:29:29 - 0:00:15 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 08:29:29 - 0:00:15 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 08:29:29 - 0:00:15 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 08:29:29 - 0:00:15 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 08:29:29 - 0:00:16 - Removed 0 empty sentences.

INFO - 07/13/22 08:29:29 - 0:00:16 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 08:29:30 - 0:00:16 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:29:30 - 0:00:16 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 08:29:30 - 0:00:16 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:29:30 - 0:00:16 - Removed 0 empty sentences.


INFO - 07/13/22 08:29:30 - 0:00:16 - ============ Data summary
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 08:29:30 - 0:00:16 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 08:29:30 - 0:00:16 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 08:29:30 - 0:00:16 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 08:29:44 - 0:00:30 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
DEBUG - 07/13/22 08:30:38 - 0:01:24 - S3PathHandler couldn't be imported. Either missing fb-only files, or boto3 module.
INFO - 07/13/22 08:42:52 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 08:42:52 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 08:42:52 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 08:42:52 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 08:42:52 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 08:42:52 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 08:42:52 - 0:00:01 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:42:53 - 0:00:02 - Removed 0 empty sentences.
INFO - 07/13/22 08:42:53 - 0:00:02 - Removed 6354 too long sentences.

INFO - 07/13/22 08:42:53 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 08:42:53 - 0:00:02 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 08:42:54 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 08:42:54 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 08:42:54 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 08:42:54 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 08:42:54 - 0:00:03 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:42:56 - 0:00:04 - Removed 0 empty sentences.
INFO - 07/13/22 08:42:56 - 0:00:05 - Removed 13059 too long sentences.

INFO - 07/13/22 08:42:56 - 0:00:05 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 08:42:56 - 0:00:05 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 08:42:56 - 0:00:05 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 08:42:56 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 08:42:57 - 0:00:05 - ============ Parallel data (de-en)
INFO - 07/13/22 08:42:57 - 0:00:05 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 08:42:57 - 0:00:05 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 08:42:57 - 0:00:05 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 08:42:57 - 0:00:05 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 08:42:57 - 0:00:06 - Removed 0 empty sentences.

INFO - 07/13/22 08:42:57 - 0:00:06 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 08:42:57 - 0:00:06 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:42:57 - 0:00:06 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 08:42:57 - 0:00:06 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:42:58 - 0:00:06 - Removed 0 empty sentences.


INFO - 07/13/22 08:42:58 - 0:00:06 - ============ Data summary
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 08:42:58 - 0:00:06 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 08:42:58 - 0:00:06 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 08:42:58 - 0:00:06 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 08:43:04 - 0:00:12 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
INFO - 07/13/22 08:46:30 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 08:46:30 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 08:46:30 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 08:46:30 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 08:46:30 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 08:46:30 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 08:46:30 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:46:31 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 08:46:31 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 08:46:31 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 08:46:31 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 08:46:32 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 08:46:32 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 08:46:32 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 08:46:32 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 08:46:32 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:46:33 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/13/22 08:46:33 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 08:46:34 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 08:46:34 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 08:46:34 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 08:46:34 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 08:46:34 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 08:46:34 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 08:46:34 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 08:46:34 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 08:46:34 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 08:46:34 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 08:46:34 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 08:46:34 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:46:34 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 08:46:34 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:46:35 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 08:46:35 - 0:00:05 - ============ Data summary
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 08:46:35 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 08:46:35 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 08:46:35 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 08:46:40 - 0:00:10 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
INFO - 07/13/22 08:50:37 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 08:50:37 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 08:50:37 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 08:50:37 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 08:50:37 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 08:50:37 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 08:50:38 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:50:39 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 08:50:39 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 08:50:39 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 08:50:39 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 08:50:39 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 08:50:39 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 08:50:39 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 08:50:39 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 08:50:40 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:50:41 - 0:00:04 - Removed 0 empty sentences.
INFO - 07/13/22 08:50:41 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 08:50:41 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 08:50:41 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 08:50:42 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 08:50:42 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 08:50:42 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 08:50:42 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 08:50:42 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 08:50:42 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 08:50:42 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 08:50:42 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 08:50:42 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 08:50:42 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:50:42 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 08:50:42 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:50:43 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 08:50:43 - 0:00:05 - ============ Data summary
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 08:50:43 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 08:50:43 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 08:50:43 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 08:51:11 - 0:00:33 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
INFO - 07/13/22 08:53:27 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 08:53:27 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 08:53:27 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 08:53:27 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt,F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 08:53:27 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 08:53:27 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 08:53:28 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:53:29 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 08:53:29 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 08:53:29 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 08:53:29 - 0:00:02 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 08:53:29 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 08:53:29 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 08:53:29 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 08:53:29 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 08:53:30 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:53:31 - 0:00:04 - Removed 0 empty sentences.
INFO - 07/13/22 08:53:31 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 08:53:31 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 08:53:31 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 08:53:32 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 08:53:32 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 08:53:32 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 08:53:32 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 08:53:32 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 08:53:32 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 08:53:32 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 08:53:32 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 08:53:32 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 08:53:32 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:53:32 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 08:53:32 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 08:53:33 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 08:53:33 - 0:00:05 - ============ Data summary
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 08:53:33 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 08:53:33 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 08:53:33 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 08:53:49 - 0:00:22 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR-base\\xlmr.base\\model.pt ...
INFO - 07/13/22 09:02:56 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 09:02:56 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 09:02:56 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 09:02:56 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 09:02:56 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 09:02:56 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 09:02:56 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:02:57 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 09:02:57 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 09:02:57 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 09:02:57 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 09:02:58 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 09:02:58 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 09:02:58 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 09:02:58 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 09:02:58 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:03:00 - 0:00:04 - Removed 0 empty sentences.
INFO - 07/13/22 09:03:00 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 09:03:00 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 09:03:00 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 09:03:00 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 09:03:00 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 09:03:00 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 09:03:00 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 09:03:00 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 09:03:00 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 09:03:00 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 09:03:01 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 09:03:01 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 09:03:01 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:03:01 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 09:03:01 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:03:01 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 09:03:01 - 0:00:05 - ============ Data summary
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 09:03:01 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 09:03:01 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 09:03:01 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 09:03:16 - 0:00:20 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 09:52:13 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 09:52:13 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 09:52:13 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 09:52:13 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 09:52:13 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 09:52:13 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 09:52:14 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:52:14 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 09:52:15 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 09:52:15 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 09:52:15 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 09:52:15 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 09:52:15 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 09:52:15 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 09:52:15 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 09:52:15 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:52:17 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/13/22 09:52:17 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 09:52:17 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 09:52:17 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 09:52:17 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 09:52:17 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 09:52:17 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 09:52:17 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 09:52:17 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 09:52:17 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 09:52:17 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 09:52:18 - 0:00:04 - Removed 0 empty sentences.

INFO - 07/13/22 09:52:18 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 09:52:18 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:52:18 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 09:52:18 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:52:18 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 09:52:18 - 0:00:05 - ============ Data summary
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 09:52:18 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 09:52:18 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 09:52:18 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 09:52:27 - 0:00:14 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 09:53:34 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 09:53:34 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 09:53:34 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 09:53:34 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 09:53:34 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 09:53:34 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 09:53:34 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:53:35 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 09:53:35 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 09:53:35 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 09:53:35 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 09:53:35 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 09:53:35 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 09:53:36 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 09:53:36 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 09:53:36 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:53:37 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/13/22 09:53:37 - 0:00:04 - Removed 13059 too long sentences.

INFO - 07/13/22 09:53:37 - 0:00:04 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 09:53:37 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 09:53:38 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 09:53:38 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 09:53:38 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 09:53:38 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 09:53:38 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 09:53:38 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 09:53:38 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 09:53:38 - 0:00:05 - Removed 0 empty sentences.

INFO - 07/13/22 09:53:38 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 09:53:38 - 0:00:05 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:53:38 - 0:00:05 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 09:53:38 - 0:00:05 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:53:39 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 09:53:39 - 0:00:05 - ============ Data summary
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 09:53:39 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 09:53:39 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 09:53:39 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 09:53:44 - 0:00:10 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 09:53:53 - 0:00:19 - loading archive file F:\project\UNMT\LM\XLMR\xlmr.base
DEBUG - 07/13/22 09:53:54 - 0:00:20 - Setting JobRuntime:name=UNKNOWN_NAME
DEBUG - 07/13/22 09:53:54 - 0:00:20 - Setting JobRuntime:name=utils
DEBUG - 07/13/22 09:53:59 - 0:00:25 - Setting JobRuntime:name=utils
INFO - 07/13/22 09:54:04 - 0:00:31 - dictionary: 250001 types
INFO - 07/13/22 09:55:49 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 09:55:49 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: False
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 09:55:49 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 09:55:49 - 0:00:00 - Running command: python train.py --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 09:55:49 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 09:55:49 - 0:00:00 - Loading data from ./data/processed/de-en/train.de.pth ...
INFO - 07/13/22 09:55:50 - 0:00:00 - 108350453 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:55:51 - 0:00:01 - Removed 0 empty sentences.
INFO - 07/13/22 09:55:51 - 0:00:01 - Removed 6354 too long sentences.

INFO - 07/13/22 09:55:51 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 09:55:51 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 09:55:51 - 0:00:02 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 09:55:51 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 09:55:51 - 0:00:02 - ============ Monolingual data (en)
INFO - 07/13/22 09:55:51 - 0:00:02 - Loading data from ./data/processed/de-en/train.en.pth ...
INFO - 07/13/22 09:55:52 - 0:00:02 - 129883113 words (60408 unique) in 5000000 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:55:53 - 0:00:03 - Removed 0 empty sentences.
INFO - 07/13/22 09:55:53 - 0:00:03 - Removed 13059 too long sentences.

INFO - 07/13/22 09:55:53 - 0:00:03 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 09:55:53 - 0:00:03 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 09:55:53 - 0:00:04 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 09:55:53 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 09:55:53 - 0:00:04 - ============ Parallel data (de-en)
INFO - 07/13/22 09:55:53 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 09:55:53 - 0:00:04 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 09:55:53 - 0:00:04 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 09:55:53 - 0:00:04 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 09:55:54 - 0:00:04 - Removed 0 empty sentences.

INFO - 07/13/22 09:55:54 - 0:00:04 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 09:55:54 - 0:00:04 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:55:54 - 0:00:04 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 09:55:54 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 09:55:54 - 0:00:05 - Removed 0 empty sentences.


INFO - 07/13/22 09:55:54 - 0:00:05 - ============ Data summary
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   - train -           de:   5000000
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   - train -           en:   5000000
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 09:55:54 - 0:00:05 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 09:55:54 - 0:00:05 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 09:55:54 - 0:00:05 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 09:55:59 - 0:00:10 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 09:56:08 - 0:00:19 - loading archive file F:\project\UNMT\LM\XLMR\xlmr.base
DEBUG - 07/13/22 09:56:08 - 0:00:19 - Setting JobRuntime:name=UNKNOWN_NAME
DEBUG - 07/13/22 09:56:08 - 0:00:19 - Setting JobRuntime:name=utils
DEBUG - 07/13/22 09:56:13 - 0:00:24 - Setting JobRuntime:name=utils
INFO - 07/13/22 09:56:19 - 0:00:30 - dictionary: 250001 types
INFO - 07/13/22 15:20:10 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 15:20:10 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 15:20:10 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 15:20:10 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 15:20:10 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 15:20:10 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 15:20:10 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 15:20:10 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 15:20:10 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 15:20:11 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 15:20:11 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 15:20:11 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 15:20:11 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 15:20:11 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 15:20:11 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 15:20:11 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 15:20:11 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 15:20:11 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 15:20:11 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 15:20:12 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 15:20:12 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 15:20:12 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 15:20:12 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 15:20:12 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 15:20:12 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 15:20:12 - 0:00:02 - ============ Data summary
INFO - 07/13/22 15:20:12 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 15:20:12 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 15:20:12 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 15:20:12 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 15:20:12 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 15:20:12 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 15:21:33 - 0:01:23 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt ...
INFO - 07/13/22 16:31:34 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 16:31:34 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large --word_mask_keep_rand 1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR\\xlmr.large --word_mask_keep_rand 1,0,0
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.1
                                     word_mask: 0.8
                                     word_mask_keep_rand: 0.8,0.1,0.1
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.1
                                     word_shuffle: 0
INFO - 07/13/22 16:31:34 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 16:31:34 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large --word_mask_keep_rand 1,0,0'

INFO - 07/13/22 16:31:34 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 16:31:34 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 16:31:34 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 16:31:34 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 16:31:34 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 16:31:34 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 16:31:34 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 16:31:34 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 16:31:35 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 16:31:35 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 16:31:35 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 16:31:35 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 16:31:35 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 16:31:35 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 16:31:35 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 16:31:35 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 16:31:35 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 16:31:35 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:31:35 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 16:31:35 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:31:36 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 16:31:36 - 0:00:02 - ============ Data summary
INFO - 07/13/22 16:31:36 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 16:31:36 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 16:31:36 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 16:31:36 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 16:31:36 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 16:31:36 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 16:31:46 - 0:00:12 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 16:32:19 - 0:00:44 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 16:32:20 - 0:00:46 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 16:32:20 - 0:00:46 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 16:32:20 - 0:00:46 - Number of parameters (encoder): 138023928
INFO - 07/13/22 16:32:20 - 0:00:46 - Number of parameters (decoder): 169524216
DEBUG - 07/13/22 16:32:21 - 0:00:46 - Starting new HTTPS connection (1): huggingface.co:443
DEBUG - 07/13/22 16:32:22 - 0:00:48 - https://huggingface.co:443 "HEAD /F:%5C%5Cproject%5C%5CUNMT%5C%5CLM%5C%5CXLMR%5C%5Cxlmr.large%20--word_mask_keep_rand%201,0,0/resolve/main/config.json HTTP/1.1" 401 0
INFO - 07/13/22 16:35:12 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 16:35:12 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR --word_mask_keep_rand 1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR --word_mask_keep_rand 1,0,0
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.1
                                     word_mask: 0.8
                                     word_mask_keep_rand: 0.8,0.1,0.1
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.1
                                     word_shuffle: 0
INFO - 07/13/22 16:35:12 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 16:35:12 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR --word_mask_keep_rand 1,0,0'

INFO - 07/13/22 16:35:12 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 16:35:12 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 16:35:12 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 16:35:12 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 16:35:12 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 16:35:12 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 16:35:12 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 16:35:12 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 16:35:12 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 16:35:12 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 16:35:12 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 16:35:12 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 16:35:12 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 16:35:12 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 16:35:12 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 16:35:13 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 16:35:13 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 16:35:13 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:35:13 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 16:35:13 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:35:13 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 16:35:13 - 0:00:02 - ============ Data summary
INFO - 07/13/22 16:35:13 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 16:35:13 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 16:35:13 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 16:35:13 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 16:35:13 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 16:35:13 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 16:35:16 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 16:35:19 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 16:35:21 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 16:35:21 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 16:35:21 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 16:35:21 - 0:00:09 - Number of parameters (decoder): 169524216
DEBUG - 07/13/22 16:35:21 - 0:00:09 - Starting new HTTPS connection (1): huggingface.co:443
DEBUG - 07/13/22 16:35:22 - 0:00:11 - https://huggingface.co:443 "HEAD /F:%5C%5Cproject%5C%5CUNMT%5C%5CLM%5C%5CXLMR%20--word_mask_keep_rand%201,0,0/resolve/main/config.json HTTP/1.1" 401 0
INFO - 07/13/22 16:36:21 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 16:36:21 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 16:36:21 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 16:36:21 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 16:36:21 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 16:36:21 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 16:36:21 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 16:36:21 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 16:36:21 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 16:36:22 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 16:36:22 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 16:36:22 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 16:36:22 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 16:36:22 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 16:36:22 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 16:36:22 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 16:36:22 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 16:36:22 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 16:36:22 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 16:36:22 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 16:36:22 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 16:36:23 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:36:23 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 16:36:23 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 16:36:23 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 16:36:23 - 0:00:02 - ============ Data summary
INFO - 07/13/22 16:36:23 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 16:36:23 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 16:36:23 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 16:36:23 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 16:36:23 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 16:36:23 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 16:36:26 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 16:36:29 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 16:36:30 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 16:36:30 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 16:36:30 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 16:36:30 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 17:12:09 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 17:12:09 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 17:12:09 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 17:12:09 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 17:12:09 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 17:12:09 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 17:12:09 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 17:12:09 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 17:12:09 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 17:12:10 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 17:12:10 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 17:12:10 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 17:12:10 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 17:12:10 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 17:12:10 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 17:12:10 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 17:12:10 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 17:12:10 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 17:12:10 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 17:12:11 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 17:12:11 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 17:12:11 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:12:11 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 17:12:11 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:12:11 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 17:12:11 - 0:00:02 - ============ Data summary
INFO - 07/13/22 17:12:11 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 17:12:11 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 17:12:11 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 17:12:11 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 17:12:11 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 17:12:11 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 17:12:14 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 17:12:17 - 0:00:08 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 17:12:19 - 0:00:10 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 17:12:19 - 0:00:10 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 17:12:19 - 0:00:10 - Number of parameters (encoder): 138023928
INFO - 07/13/22 17:12:19 - 0:00:10 - Number of parameters (decoder): 169524216
INFO - 07/13/22 17:18:17 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 17:18:17 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 17:18:17 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 17:18:17 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 17:18:17 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 17:18:17 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 17:18:17 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 17:18:17 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 17:18:17 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 17:18:17 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 17:18:17 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 17:18:17 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 17:18:18 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 17:18:18 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 17:18:18 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 17:18:18 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 17:18:18 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 17:18:18 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 17:18:18 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 17:18:18 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 17:18:18 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 17:18:18 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:18:18 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 17:18:18 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:18:19 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 17:18:19 - 0:00:02 - ============ Data summary
INFO - 07/13/22 17:18:19 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 17:18:19 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 17:18:19 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 17:18:19 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 17:18:19 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 17:18:19 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 17:18:22 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 17:18:24 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 17:18:26 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 17:18:26 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 17:18:26 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 17:18:26 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 17:20:32 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 17:20:32 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 17:20:32 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 17:20:32 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 17:20:32 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 17:20:32 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 17:20:32 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 17:20:32 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 17:20:32 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 17:20:32 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 17:20:32 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 17:20:32 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 17:20:32 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 17:20:32 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 17:20:32 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 17:20:32 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 17:20:33 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 17:20:33 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 17:20:33 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 17:20:33 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 17:20:33 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 17:20:33 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:20:33 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 17:20:33 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 17:20:33 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 17:20:33 - 0:00:02 - ============ Data summary
INFO - 07/13/22 17:20:33 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 17:20:33 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 17:20:33 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 17:20:33 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 17:20:33 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 17:20:33 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 17:20:36 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 17:20:39 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 17:20:40 - 0:00:08 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 17:20:40 - 0:00:08 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 17:20:40 - 0:00:08 - Number of parameters (encoder): 138023928
INFO - 07/13/22 17:20:40 - 0:00:08 - Number of parameters (decoder): 169524216
INFO - 07/13/22 20:46:19 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 20:46:19 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 20:46:19 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 20:46:19 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 20:46:19 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 20:46:19 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 20:46:19 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 20:46:19 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 20:46:19 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 20:46:20 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 20:46:20 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 20:46:20 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 20:46:20 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 20:46:20 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 20:46:20 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 20:46:20 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 20:46:20 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 20:46:20 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 20:46:20 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 20:46:21 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 20:46:21 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 20:46:21 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:46:21 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 20:46:21 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:46:21 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 20:46:21 - 0:00:02 - ============ Data summary
INFO - 07/13/22 20:46:21 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 20:46:21 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 20:46:21 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 20:46:21 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 20:46:21 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 20:46:21 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 20:46:24 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 20:46:27 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 20:46:28 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 20:46:28 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 20:46:28 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 20:46:28 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 20:47:06 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 20:47:06 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 20:47:06 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 20:47:06 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 20:47:06 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 20:47:06 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 20:47:06 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 20:47:06 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 20:47:06 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 20:47:06 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 20:47:06 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 20:47:06 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 20:47:07 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 20:47:07 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 20:47:07 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 20:47:07 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 20:47:07 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 20:47:07 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 20:47:07 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 20:47:07 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 20:47:07 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 20:47:07 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:47:07 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 20:47:07 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:47:08 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 20:47:08 - 0:00:02 - ============ Data summary
INFO - 07/13/22 20:47:08 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 20:47:08 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 20:47:08 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 20:47:08 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 20:47:08 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 20:47:08 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 20:47:11 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 20:47:13 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 20:47:15 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 20:47:15 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 20:47:15 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 20:47:15 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 20:59:21 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 20:59:21 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 20:59:21 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 20:59:21 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 20:59:21 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 20:59:21 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 20:59:21 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 20:59:21 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 20:59:21 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 20:59:21 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 20:59:21 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 20:59:21 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 20:59:21 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 20:59:21 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 20:59:22 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 20:59:22 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 20:59:22 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 20:59:22 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 20:59:22 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 20:59:22 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 20:59:22 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 20:59:22 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:59:22 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 20:59:22 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 20:59:23 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 20:59:23 - 0:00:02 - ============ Data summary
INFO - 07/13/22 20:59:23 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 20:59:23 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 20:59:23 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 20:59:23 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 20:59:23 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 20:59:23 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 20:59:26 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 20:59:28 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 20:59:30 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 20:59:30 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 20:59:30 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 20:59:30 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 21:22:13 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 21:22:13 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 21:22:13 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 21:22:13 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 21:22:13 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 21:22:13 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 21:22:13 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 21:22:13 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 21:22:13 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 21:22:13 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 21:22:13 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 21:22:13 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 21:22:13 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 21:22:14 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 21:22:14 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 21:22:14 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 21:22:14 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 21:22:14 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 21:22:14 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 21:22:15 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 21:22:15 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 21:22:15 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:22:15 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 21:22:15 - 0:00:03 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:22:17 - 0:00:04 - Removed 0 empty sentences.


INFO - 07/13/22 21:22:17 - 0:00:04 - ============ Data summary
INFO - 07/13/22 21:22:17 - 0:00:04 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 21:22:17 - 0:00:04 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 21:22:17 - 0:00:04 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 21:22:17 - 0:00:04 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 21:22:17 - 0:00:04 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 21:22:17 - 0:00:04 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 21:22:22 - 0:00:09 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 21:22:25 - 0:00:12 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 21:22:27 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 21:22:27 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 21:22:27 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/13/22 21:22:27 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/13/22 21:23:28 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 21:23:28 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 21:23:28 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 21:23:28 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 21:23:28 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 21:23:28 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 21:23:28 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 21:23:28 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 21:23:28 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 21:23:28 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 21:23:28 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 21:23:28 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 21:23:28 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 21:23:28 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 21:23:29 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 21:23:29 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 21:23:29 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 21:23:29 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 21:23:29 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 21:23:29 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 21:23:29 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 21:23:29 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:23:29 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 21:23:29 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:23:30 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 21:23:30 - 0:00:02 - ============ Data summary
INFO - 07/13/22 21:23:30 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 21:23:30 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 21:23:30 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 21:23:30 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 21:23:30 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 21:23:30 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 21:23:34 - 0:00:07 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 21:23:38 - 0:00:10 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 21:23:40 - 0:00:12 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 21:23:40 - 0:00:12 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 21:23:40 - 0:00:12 - Number of parameters (encoder): 138023928
INFO - 07/13/22 21:23:40 - 0:00:12 - Number of parameters (decoder): 169524216
INFO - 07/13/22 21:34:40 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 21:34:40 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 21:34:40 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 21:34:40 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 21:34:40 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 21:34:40 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 21:34:40 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 21:34:40 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 21:34:40 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 21:34:41 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 21:34:41 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 21:34:41 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 21:34:41 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 21:34:41 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 21:34:42 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 21:34:42 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 21:34:42 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 21:34:42 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 21:34:42 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 21:34:43 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 21:34:43 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 21:34:43 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:34:43 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 21:34:43 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:34:43 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/13/22 21:34:43 - 0:00:03 - ============ Data summary
INFO - 07/13/22 21:34:43 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 21:34:43 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 21:34:43 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 21:34:43 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 21:34:43 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 21:34:43 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 21:34:48 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 21:34:51 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 21:34:54 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 21:34:54 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 21:34:54 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/13/22 21:34:54 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/13/22 21:36:12 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 21:36:12 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 21:36:12 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 21:36:12 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 21:36:12 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 21:36:12 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 21:36:12 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 21:36:12 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 21:36:12 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 21:36:12 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 21:36:12 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 21:36:12 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 21:36:13 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 21:36:13 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 21:36:13 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 21:36:13 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 21:36:13 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 21:36:13 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 21:36:13 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 21:36:14 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 21:36:14 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 21:36:14 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:36:14 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 21:36:14 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:36:15 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/13/22 21:36:15 - 0:00:03 - ============ Data summary
INFO - 07/13/22 21:36:15 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 21:36:15 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 21:36:15 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 21:36:15 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 21:36:15 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 21:36:15 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 21:36:20 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 21:36:23 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 21:36:26 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 21:36:26 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 21:36:26 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/13/22 21:36:26 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/13/22 21:44:16 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 21:44:16 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 21:44:16 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 21:44:16 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 21:44:16 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 21:44:16 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 21:44:16 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 21:44:16 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 21:44:16 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 21:44:17 - 0:00:01 - ============ Monolingual data (en)
INFO - 07/13/22 21:44:17 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 21:44:17 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 21:44:17 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 21:44:17 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 21:44:17 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 21:44:17 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 21:44:17 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 21:44:17 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 21:44:18 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 21:44:18 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/13/22 21:44:18 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 21:44:18 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:44:18 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 21:44:18 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 21:44:19 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/13/22 21:44:19 - 0:00:03 - ============ Data summary
INFO - 07/13/22 21:44:19 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 21:44:19 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 21:44:19 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 21:44:19 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 21:44:19 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 21:44:19 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 21:44:24 - 0:00:07 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 21:44:27 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 21:44:30 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 21:44:30 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 21:44:30 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/13/22 21:44:30 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/13/22 23:16:02 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 23:16:02 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 23:16:02 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 23:16:02 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 23:16:02 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 23:16:02 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 23:16:02 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 23:16:02 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 23:16:02 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 23:16:03 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 23:16:03 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 23:16:03 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 23:16:03 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 23:16:03 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 23:16:03 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 23:16:03 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 23:16:03 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 23:16:03 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 23:16:03 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 23:16:03 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 23:16:03 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 23:16:03 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:16:04 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 23:16:04 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:16:04 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 23:16:04 - 0:00:02 - ============ Data summary
INFO - 07/13/22 23:16:04 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 23:16:04 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 23:16:04 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 23:16:04 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 23:16:04 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 23:16:04 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 23:16:07 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 23:16:09 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 23:16:11 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 23:16:11 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 23:16:11 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 23:16:11 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 23:20:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 23:20:53 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 23:20:53 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 23:20:53 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 23:20:53 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 23:20:53 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 23:20:53 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 23:20:53 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 23:20:53 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 23:20:53 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 23:20:53 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 23:20:53 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 23:20:53 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 23:20:53 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 23:20:54 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 23:20:54 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 23:20:54 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 23:20:54 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 23:20:54 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 23:20:54 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 23:20:54 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 23:20:54 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:20:54 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 23:20:54 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:20:54 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 23:20:54 - 0:00:02 - ============ Data summary
INFO - 07/13/22 23:20:54 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 23:20:54 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 23:20:54 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 23:20:54 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 23:20:54 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 23:20:54 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 23:20:57 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 23:21:00 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 23:21:02 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 23:21:02 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 23:21:02 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/13/22 23:21:02 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/13/22 23:26:45 - 0:00:00 - ============ Initialized logger ============
INFO - 07/13/22 23:26:45 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/13/22 23:26:45 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/13/22 23:26:45 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/13/22 23:26:45 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/13/22 23:26:45 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/13/22 23:26:45 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/13/22 23:26:45 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/13/22 23:26:45 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/13/22 23:26:45 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/13/22 23:26:45 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/13/22 23:26:45 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/13/22 23:26:45 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/13/22 23:26:45 - 0:00:00 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/13/22 23:26:45 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/13/22 23:26:45 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/13/22 23:26:45 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/13/22 23:26:45 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/13/22 23:26:45 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/13/22 23:26:46 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/13/22 23:26:46 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/13/22 23:26:46 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:26:46 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/13/22 23:26:46 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/13/22 23:26:46 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/13/22 23:26:46 - 0:00:02 - ============ Data summary
INFO - 07/13/22 23:26:46 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/13/22 23:26:46 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/13/22 23:26:46 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/13/22 23:26:46 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/13/22 23:26:46 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/13/22 23:26:46 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/13/22 23:26:49 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/13/22 23:26:51 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/13/22 23:26:53 - 0:00:08 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/13/22 23:26:53 - 0:00:08 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/13/22 23:26:53 - 0:00:08 - Number of parameters (encoder): 138023928
INFO - 07/13/22 23:26:53 - 0:00:08 - Number of parameters (decoder): 169524216
INFO - 07/14/22 10:41:57 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 10:41:57 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 10:41:57 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 10:41:57 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 10:41:57 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 10:41:57 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 10:41:57 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 10:41:57 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 10:41:57 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 10:41:58 - 0:00:01 - ============ Monolingual data (en)
INFO - 07/14/22 10:41:58 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 10:41:58 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 10:41:58 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 10:41:58 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 10:41:58 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 10:41:58 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 10:41:59 - 0:00:02 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 10:41:59 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 10:41:59 - 0:00:02 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 10:41:59 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 10:41:59 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 10:41:59 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 10:41:59 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 10:42:00 - 0:00:03 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 10:42:00 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 10:42:00 - 0:00:03 - ============ Data summary
INFO - 07/14/22 10:42:00 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 10:42:00 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 10:42:00 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 10:42:00 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 10:42:00 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 10:42:00 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 10:42:03 - 0:00:06 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 10:42:27 - 0:00:30 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 10:42:29 - 0:00:32 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 10:42:29 - 0:00:32 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 10:42:29 - 0:00:32 - Number of parameters (encoder): 138023928
INFO - 07/14/22 10:42:29 - 0:00:32 - Number of parameters (decoder): 169524216
INFO - 07/14/22 11:21:59 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 11:21:59 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 11:21:59 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 11:21:59 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 11:21:59 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 11:21:59 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 11:21:59 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 11:21:59 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 11:21:59 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 11:22:00 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 11:22:00 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 11:22:00 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 11:22:00 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 11:22:00 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 11:22:00 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 11:22:00 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 11:22:00 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 11:22:00 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 11:22:00 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 11:22:00 - 0:00:01 - Removed 0 empty sentences.

INFO - 07/14/22 11:22:00 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 11:22:00 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 11:22:00 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 11:22:01 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 11:22:01 - 0:00:02 - Removed 0 empty sentences.


INFO - 07/14/22 11:22:01 - 0:00:02 - ============ Data summary
INFO - 07/14/22 11:22:01 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 11:22:01 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 11:22:01 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 11:22:01 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 11:22:01 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 11:22:01 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 11:22:04 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 11:22:07 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 11:22:08 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 11:22:08 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 11:22:08 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 07/14/22 11:22:08 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 07/14/22 15:46:05 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 15:46:05 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 15:46:05 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 15:46:05 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 15:46:05 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 15:46:05 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 15:46:05 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 15:46:06 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 15:46:06 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 15:46:06 - 0:00:01 - ============ Monolingual data (en)
INFO - 07/14/22 15:46:06 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 15:46:06 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 15:46:07 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 15:46:07 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 15:46:07 - 0:00:02 - ============ Parallel data (de-en)
INFO - 07/14/22 15:46:07 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 15:46:07 - 0:00:02 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 15:46:07 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 15:46:07 - 0:00:02 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 15:46:08 - 0:00:03 - Removed 0 empty sentences.

INFO - 07/14/22 15:46:08 - 0:00:03 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 15:46:08 - 0:00:03 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 15:46:08 - 0:00:03 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 15:46:08 - 0:00:03 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 15:46:09 - 0:00:04 - Removed 0 empty sentences.


INFO - 07/14/22 15:46:09 - 0:00:04 - ============ Data summary
INFO - 07/14/22 15:46:09 - 0:00:04 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 15:46:09 - 0:00:04 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 15:46:09 - 0:00:04 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 15:46:09 - 0:00:04 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 15:46:09 - 0:00:04 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 15:46:09 - 0:00:04 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 15:46:15 - 0:00:10 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 15:46:40 - 0:00:34 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 15:46:42 - 0:00:36 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 15:46:42 - 0:00:36 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 15:46:42 - 0:00:36 - Number of parameters (encoder): 138023928
INFO - 07/14/22 15:46:42 - 0:00:36 - Number of parameters (decoder): 169524216
INFO - 07/14/22 16:35:51 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 16:35:51 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 16:35:51 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 16:35:51 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 16:35:51 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 16:35:51 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 16:35:51 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 16:35:51 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 16:35:51 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 16:35:52 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 16:35:52 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 16:35:52 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 16:35:52 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 16:35:52 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 16:35:52 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 16:35:52 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 16:35:53 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 16:35:53 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 16:35:53 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 16:35:53 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 16:35:53 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 16:35:53 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 16:35:53 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 16:35:53 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 16:35:54 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 16:35:54 - 0:00:03 - ============ Data summary
INFO - 07/14/22 16:35:54 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 16:35:54 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 16:35:54 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 16:35:54 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 16:35:54 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 16:35:54 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 16:36:00 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 16:36:03 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 16:36:05 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 16:36:05 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 16:36:05 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/14/22 16:36:05 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/14/22 16:40:42 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 16:40:42 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 16:40:42 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 16:40:42 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 16:40:42 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 16:40:42 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 16:40:42 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 16:40:42 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 16:40:42 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 16:40:42 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 16:40:42 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 16:40:42 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 16:40:43 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 16:40:43 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 16:40:43 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 16:40:43 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 16:40:43 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 16:40:43 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 16:40:43 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 16:40:44 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 16:40:44 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 16:40:44 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 16:40:44 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 16:40:44 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 16:40:45 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 16:40:45 - 0:00:03 - ============ Data summary
INFO - 07/14/22 16:40:45 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 16:40:45 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 16:40:45 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 16:40:45 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 16:40:45 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 16:40:45 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 16:40:50 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 16:40:53 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 16:40:55 - 0:00:13 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 16:40:55 - 0:00:13 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 16:40:55 - 0:00:13 - Number of parameters (encoder): 138023928
INFO - 07/14/22 16:40:55 - 0:00:13 - Number of parameters (decoder): 169524216
INFO - 07/14/22 18:37:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 18:37:54 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 18:37:54 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 18:37:54 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 18:37:54 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 18:37:54 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 18:37:54 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 18:37:54 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 18:37:54 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 18:37:54 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 18:37:54 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 18:37:54 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 18:37:54 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 18:37:54 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 18:37:55 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 18:37:55 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 18:37:55 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 18:37:55 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 18:37:55 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 18:37:56 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 18:37:56 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 18:37:56 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:37:56 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 18:37:56 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:37:56 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 18:37:56 - 0:00:03 - ============ Data summary
INFO - 07/14/22 18:37:56 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 18:37:56 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 18:37:56 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 18:37:56 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 18:37:56 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 18:37:56 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 18:38:02 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 18:38:05 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 18:38:07 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 18:38:07 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 18:38:07 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 07/14/22 18:38:07 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 07/14/22 18:44:46 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 18:44:46 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 18:44:46 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 18:44:46 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 18:44:46 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 18:44:46 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 18:44:46 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 18:44:46 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 18:44:46 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 18:44:47 - 0:00:01 - ============ Monolingual data (en)
INFO - 07/14/22 18:44:47 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 18:44:47 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 18:44:47 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 18:44:47 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 18:44:47 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 18:44:47 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 18:44:47 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 18:44:47 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 18:44:48 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 18:44:48 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 18:44:48 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 18:44:48 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:44:48 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 18:44:48 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:44:49 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 18:44:49 - 0:00:03 - ============ Data summary
INFO - 07/14/22 18:44:49 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 18:44:49 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 18:44:49 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 18:44:49 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 18:44:49 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 18:44:49 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 18:44:54 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 18:44:57 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 18:44:59 - 0:00:13 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 18:44:59 - 0:00:13 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 18:44:59 - 0:00:13 - Number of parameters (encoder): 138023928
INFO - 07/14/22 18:44:59 - 0:00:13 - Number of parameters (decoder): 169524216
INFO - 07/14/22 18:46:03 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 18:46:03 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 18:46:03 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 18:46:03 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 18:46:03 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 18:46:03 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 18:46:03 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 18:46:03 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 18:46:03 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 18:46:04 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 18:46:04 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 18:46:04 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 18:46:04 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 18:46:04 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 18:46:04 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 18:46:04 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 18:46:05 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 18:46:05 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 18:46:05 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 18:46:05 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 18:46:05 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 18:46:05 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:46:05 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 18:46:05 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:46:06 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 18:46:06 - 0:00:03 - ============ Data summary
INFO - 07/14/22 18:46:06 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 18:46:06 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 18:46:06 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 18:46:06 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 18:46:06 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 18:46:06 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 18:46:11 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 18:46:14 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 18:46:17 - 0:00:13 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 18:46:17 - 0:00:13 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 18:46:17 - 0:00:13 - Number of parameters (encoder): 138023928
INFO - 07/14/22 18:46:17 - 0:00:13 - Number of parameters (decoder): 169524216
INFO - 07/14/22 18:52:48 - 0:00:00 - ============ Initialized logger ============
INFO - 07/14/22 18:52:48 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 07/14/22 18:52:48 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 07/14/22 18:52:48 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0'

INFO - 07/14/22 18:52:48 - 0:00:00 - ============ Monolingual data (de)
INFO - 07/14/22 18:52:48 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 07/14/22 18:52:48 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 07/14/22 18:52:48 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 07/14/22 18:52:48 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 07/14/22 18:52:48 - 0:00:00 - ============ Monolingual data (en)
INFO - 07/14/22 18:52:48 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 07/14/22 18:52:48 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 07/14/22 18:52:49 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 07/14/22 18:52:49 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 07/14/22 18:52:49 - 0:00:01 - ============ Parallel data (de-en)
INFO - 07/14/22 18:52:49 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 07/14/22 18:52:49 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 07/14/22 18:52:49 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 07/14/22 18:52:49 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 07/14/22 18:52:50 - 0:00:02 - Removed 0 empty sentences.

INFO - 07/14/22 18:52:50 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 07/14/22 18:52:50 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:52:50 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 07/14/22 18:52:50 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 07/14/22 18:52:51 - 0:00:03 - Removed 0 empty sentences.


INFO - 07/14/22 18:52:51 - 0:00:03 - ============ Data summary
INFO - 07/14/22 18:52:51 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 07/14/22 18:52:51 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 07/14/22 18:52:51 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 07/14/22 18:52:51 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 07/14/22 18:52:51 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 07/14/22 18:52:51 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 07/14/22 18:52:56 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 07/14/22 18:52:59 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 07/14/22 18:53:01 - 0:00:13 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 07/14/22 18:53:01 - 0:00:13 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 07/14/22 18:53:01 - 0:00:13 - Number of parameters (encoder): 138023928
INFO - 07/14/22 18:53:01 - 0:00:13 - Number of parameters (decoder): 169524216
INFO - 08/01/22 20:25:26 - 0:00:00 - ============ Initialized logger ============
INFO - 08/01/22 20:25:26 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 08/01/22 20:25:26 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 08/01/22 20:25:26 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4

INFO - 08/01/22 20:25:26 - 0:00:00 - ============ Monolingual data (de)
INFO - 08/01/22 20:25:26 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 08/01/22 20:25:26 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 08/01/22 20:25:26 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 08/01/22 20:25:26 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 08/01/22 20:25:26 - 0:00:01 - ============ Monolingual data (en)
INFO - 08/01/22 20:25:26 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 08/01/22 20:25:26 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 08/01/22 20:25:26 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 08/01/22 20:25:27 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 08/01/22 20:25:27 - 0:00:01 - ============ Parallel data (de-en)
INFO - 08/01/22 20:25:27 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 08/01/22 20:25:27 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 08/01/22 20:25:27 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 08/01/22 20:25:27 - 0:00:02 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 08/01/22 20:25:28 - 0:00:02 - Removed 0 empty sentences.

INFO - 08/01/22 20:25:28 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 08/01/22 20:25:28 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 08/01/22 20:25:28 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 08/01/22 20:25:28 - 0:00:03 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 08/01/22 20:25:29 - 0:00:03 - Removed 0 empty sentences.


INFO - 08/01/22 20:25:29 - 0:00:03 - ============ Data summary
INFO - 08/01/22 20:25:29 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 08/01/22 20:25:29 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 08/01/22 20:25:29 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 08/01/22 20:25:29 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 08/01/22 20:25:29 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 08/01/22 20:25:29 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 08/01/22 20:25:33 - 0:00:07 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 08/01/22 20:25:54 - 0:00:29 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 08/01/22 20:25:56 - 0:00:30 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 08/01/22 20:25:56 - 0:00:30 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 08/01/22 20:25:56 - 0:00:30 - Number of parameters (encoder): 138023928
INFO - 08/01/22 20:25:56 - 0:00:30 - Number of parameters (decoder): 169524216
INFO - 08/01/22 20:31:49 - 0:00:00 - ============ Initialized logger ============
INFO - 08/01/22 20:31:49 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 08/01/22 20:31:49 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 08/01/22 20:31:49 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4

INFO - 08/01/22 20:31:49 - 0:00:00 - ============ Monolingual data (de)
INFO - 08/01/22 20:31:49 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 08/01/22 20:31:49 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 08/01/22 20:31:49 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 08/01/22 20:31:49 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 08/01/22 20:31:49 - 0:00:00 - ============ Monolingual data (en)
INFO - 08/01/22 20:31:49 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 08/01/22 20:31:49 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 08/01/22 20:31:49 - 0:00:00 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 08/01/22 20:31:49 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 08/01/22 20:31:49 - 0:00:01 - ============ Parallel data (de-en)
INFO - 08/01/22 20:31:49 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 08/01/22 20:31:49 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 08/01/22 20:31:49 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 08/01/22 20:31:49 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 08/01/22 20:31:50 - 0:00:01 - Removed 0 empty sentences.

INFO - 08/01/22 20:31:50 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 08/01/22 20:31:50 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 08/01/22 20:31:50 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 08/01/22 20:31:50 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 08/01/22 20:31:50 - 0:00:02 - Removed 0 empty sentences.


INFO - 08/01/22 20:31:50 - 0:00:02 - ============ Data summary
INFO - 08/01/22 20:31:50 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 08/01/22 20:31:50 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 08/01/22 20:31:50 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 08/01/22 20:31:50 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 08/01/22 20:31:50 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 08/01/22 20:31:50 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 08/01/22 20:31:53 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 08/01/22 20:31:55 - 0:00:07 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 08/01/22 20:31:57 - 0:00:09 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 08/01/22 20:31:57 - 0:00:09 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 08/01/22 20:31:57 - 0:00:09 - Number of parameters (encoder): 138023928
INFO - 08/01/22 20:31:57 - 0:00:09 - Number of parameters (decoder): 169524216
INFO - 09/21/22 21:05:13 - 0:00:00 - ============ Initialized logger ============
INFO - 09/21/22 21:05:13 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/21/22 21:05:13 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/21/22 21:05:13 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4

INFO - 09/21/22 21:05:13 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/21/22 21:05:13 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/21/22 21:05:13 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/21/22 21:05:13 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/21/22 21:05:13 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/21/22 21:05:14 - 0:00:01 - ============ Monolingual data (en)
INFO - 09/21/22 21:05:14 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/21/22 21:05:14 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/21/22 21:05:14 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/21/22 21:05:14 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/21/22 21:05:14 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/21/22 21:05:14 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/21/22 21:05:14 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/21/22 21:05:14 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/21/22 21:05:14 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/21/22 21:05:15 - 0:00:02 - Removed 0 empty sentences.

INFO - 09/21/22 21:05:15 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/21/22 21:05:15 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/21/22 21:05:15 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/21/22 21:05:15 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/21/22 21:05:15 - 0:00:02 - Removed 0 empty sentences.


INFO - 09/21/22 21:05:15 - 0:00:02 - ============ Data summary
INFO - 09/21/22 21:05:15 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 09/21/22 21:05:15 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 09/21/22 21:05:15 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 09/21/22 21:05:15 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 09/21/22 21:05:15 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 09/21/22 21:05:15 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 09/21/22 21:05:19 - 0:00:06 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 09/21/22 21:05:41 - 0:00:28 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 09/21/22 21:05:42 - 0:00:29 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 09/21/22 21:05:42 - 0:00:29 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 09/21/22 21:05:42 - 0:00:29 - Number of parameters (encoder): 138023928
INFO - 09/21/22 21:05:42 - 0:00:29 - Number of parameters (decoder): 169524216
INFO - 09/22/22 09:10:28 - 0:00:00 - ============ Initialized logger ============
INFO - 09/22/22 09:10:28 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 1
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/22/22 09:10:28 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/22/22 09:10:28 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4

INFO - 09/22/22 09:10:28 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/22/22 09:10:28 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/22/22 09:10:28 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/22/22 09:10:28 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/22/22 09:10:28 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/22/22 09:10:29 - 0:00:01 - ============ Monolingual data (en)
INFO - 09/22/22 09:10:29 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/22/22 09:10:29 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/22/22 09:10:29 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/22/22 09:10:29 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/22/22 09:10:30 - 0:00:02 - ============ Parallel data (de-en)
INFO - 09/22/22 09:10:30 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/22/22 09:10:30 - 0:00:02 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/22/22 09:10:30 - 0:00:02 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/22/22 09:10:30 - 0:00:02 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/22/22 09:10:31 - 0:00:03 - Removed 0 empty sentences.

INFO - 09/22/22 09:10:31 - 0:00:03 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/22/22 09:10:31 - 0:00:03 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:10:31 - 0:00:03 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/22/22 09:10:31 - 0:00:03 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:10:32 - 0:00:04 - Removed 0 empty sentences.


INFO - 09/22/22 09:10:32 - 0:00:04 - ============ Data summary
INFO - 09/22/22 09:10:32 - 0:00:04 - Monolingual data   - valid -           de:      3000
INFO - 09/22/22 09:10:32 - 0:00:04 - Monolingual data   -  test -           de:      2999
INFO - 09/22/22 09:10:32 - 0:00:04 - Monolingual data   - valid -           en:      3000
INFO - 09/22/22 09:10:32 - 0:00:04 - Monolingual data   -  test -           en:      2999
INFO - 09/22/22 09:10:32 - 0:00:04 - Parallel data      - valid -        de-en:      3000
INFO - 09/22/22 09:10:32 - 0:00:04 - Parallel data      -  test -        de-en:      2999

INFO - 09/22/22 09:10:39 - 0:00:11 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 09/22/22 09:11:01 - 0:00:34 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 09/22/22 09:11:05 - 0:00:37 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 09/22/22 09:11:05 - 0:00:37 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 09/22/22 09:11:05 - 0:00:37 - Number of parameters (encoder): 138023928
INFO - 09/22/22 09:11:05 - 0:00:37 - Number of parameters (decoder): 169524216
INFO - 09/22/22 09:16:51 - 0:00:00 - ============ Initialized logger ============
INFO - 09/22/22 09:16:51 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 10
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/22/22 09:16:51 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/22/22 09:16:51 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10

INFO - 09/22/22 09:16:51 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/22/22 09:16:51 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/22/22 09:16:51 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/22/22 09:16:51 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/22/22 09:16:51 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/22/22 09:16:52 - 0:00:00 - ============ Monolingual data (en)
INFO - 09/22/22 09:16:52 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/22/22 09:16:52 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/22/22 09:16:52 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/22/22 09:16:52 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/22/22 09:16:53 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/22/22 09:16:53 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/22/22 09:16:53 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/22/22 09:16:53 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/22/22 09:16:53 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/22/22 09:16:53 - 0:00:02 - Removed 0 empty sentences.

INFO - 09/22/22 09:16:53 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/22/22 09:16:54 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:16:54 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/22/22 09:16:54 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:16:55 - 0:00:03 - Removed 0 empty sentences.


INFO - 09/22/22 09:16:55 - 0:00:03 - ============ Data summary
INFO - 09/22/22 09:16:55 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 09/22/22 09:16:55 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 09/22/22 09:16:55 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 09/22/22 09:16:55 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 09/22/22 09:16:55 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 09/22/22 09:16:55 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 09/22/22 09:17:01 - 0:00:09 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 09/22/22 09:17:04 - 0:00:13 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 09/22/22 09:17:07 - 0:00:16 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 09/22/22 09:17:07 - 0:00:16 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 09/22/22 09:17:07 - 0:00:16 - Number of parameters (encoder): 138023928
INFO - 09/22/22 09:17:08 - 0:00:16 - Number of parameters (decoder): 169524216
INFO - 09/22/22 09:31:15 - 0:00:00 - ============ Initialized logger ============
INFO - 09/22/22 09:31:15 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 10
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/22/22 09:31:15 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/22/22 09:31:15 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10

INFO - 09/22/22 09:31:15 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/22/22 09:31:15 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/22/22 09:31:15 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/22/22 09:31:15 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/22/22 09:31:16 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/22/22 09:31:16 - 0:00:01 - ============ Monolingual data (en)
INFO - 09/22/22 09:31:16 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/22/22 09:31:16 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/22/22 09:31:17 - 0:00:02 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/22/22 09:31:17 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/22/22 09:31:18 - 0:00:03 - ============ Parallel data (de-en)
INFO - 09/22/22 09:31:18 - 0:00:03 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/22/22 09:31:18 - 0:00:03 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/22/22 09:31:18 - 0:00:03 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/22/22 09:31:18 - 0:00:03 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/22/22 09:31:19 - 0:00:04 - Removed 0 empty sentences.

INFO - 09/22/22 09:31:19 - 0:00:04 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/22/22 09:31:19 - 0:00:04 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:31:19 - 0:00:04 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/22/22 09:31:20 - 0:00:04 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:31:21 - 0:00:06 - Removed 0 empty sentences.


INFO - 09/22/22 09:31:21 - 0:00:06 - ============ Data summary
INFO - 09/22/22 09:31:21 - 0:00:06 - Monolingual data   - valid -           de:      3000
INFO - 09/22/22 09:31:21 - 0:00:06 - Monolingual data   -  test -           de:      2999
INFO - 09/22/22 09:31:21 - 0:00:06 - Monolingual data   - valid -           en:      3000
INFO - 09/22/22 09:31:21 - 0:00:06 - Monolingual data   -  test -           en:      2999
INFO - 09/22/22 09:31:21 - 0:00:06 - Parallel data      - valid -        de-en:      3000
INFO - 09/22/22 09:31:21 - 0:00:06 - Parallel data      -  test -        de-en:      2999

INFO - 09/22/22 09:31:30 - 0:00:15 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 09/22/22 09:31:35 - 0:00:20 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 09/22/22 09:31:38 - 0:00:23 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 09/22/22 09:31:38 - 0:00:23 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 09/22/22 09:31:38 - 0:00:23 - Number of parameters (encoder): 138023928
INFO - 09/22/22 09:31:38 - 0:00:23 - Number of parameters (decoder): 169524216
INFO - 09/22/22 09:48:06 - 0:00:00 - ============ Initialized logger ============
INFO - 09/22/22 09:48:06 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 10
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/22/22 09:48:06 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/22/22 09:48:06 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10

INFO - 09/22/22 09:48:06 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/22/22 09:48:06 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/22/22 09:48:06 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/22/22 09:48:06 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/22/22 09:48:06 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/22/22 09:48:06 - 0:00:00 - ============ Monolingual data (en)
INFO - 09/22/22 09:48:06 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/22/22 09:48:06 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/22/22 09:48:06 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/22/22 09:48:06 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/22/22 09:48:07 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/22/22 09:48:07 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/22/22 09:48:07 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/22/22 09:48:07 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/22/22 09:48:07 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/22/22 09:48:07 - 0:00:02 - Removed 0 empty sentences.

INFO - 09/22/22 09:48:07 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/22/22 09:48:07 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:48:07 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/22/22 09:48:07 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/22/22 09:48:08 - 0:00:02 - Removed 0 empty sentences.


INFO - 09/22/22 09:48:08 - 0:00:02 - ============ Data summary
INFO - 09/22/22 09:48:08 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 09/22/22 09:48:08 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 09/22/22 09:48:08 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 09/22/22 09:48:08 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 09/22/22 09:48:08 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 09/22/22 09:48:08 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 09/22/22 09:48:14 - 0:00:08 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
INFO - 09/22/22 09:48:17 - 0:00:11 - Reloading decoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
DEBUG - 09/22/22 09:48:20 - 0:00:14 - Encoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
DEBUG - 09/22/22 09:48:20 - 0:00:14 - Decoder: TransformerModel(
                                        (position_embeddings): Embedding(512, 1024)
                                        (lang_embeddings): Embedding(2, 1024)
                                        (embeddings): Embedding(60408, 1024, padding_idx=2)
                                        (layer_norm_emb): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        (attentions): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm1): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (ffns): ModuleList(
                                          (0): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (1): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (2): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (3): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (4): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                          (5): TransformerFFN(
                                            (lin1): Linear(in_features=1024, out_features=4096, bias=True)
                                            (lin2): Linear(in_features=4096, out_features=1024, bias=True)
                                          )
                                        )
                                        (layer_norm2): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (layer_norm15): ModuleList(
                                          (0): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (1): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (2): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (3): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (4): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                          (5): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
                                        )
                                        (encoder_attn): ModuleList(
                                          (0): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (1): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (2): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (3): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (4): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                          (5): MultiHeadAttention(
                                            (q_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (k_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (v_lin): Linear(in_features=1024, out_features=1024, bias=True)
                                            (out_lin): ModuleList(
                                              (0): Linear(in_features=1024, out_features=1024, bias=True)
                                              (1): Linear(in_features=1024, out_features=1024, bias=True)
                                            )
                                          )
                                        )
                                        (pred_layer): PredLayer(
                                          (proj): Linear(in_features=1024, out_features=60408, bias=True)
                                        )
                                      )
INFO - 09/22/22 09:48:20 - 0:00:14 - Number of parameters (encoder): 138023928
INFO - 09/22/22 09:48:20 - 0:00:14 - Number of parameters (decoder): 169524216
INFO - 09/27/22 00:12:52 - 0:00:00 - ============ Initialized logger ============
INFO - 09/27/22 00:12:52 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: 
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 1
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/27/22 00:12:52 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/27/22 00:12:52 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 09/27/22 00:12:52 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/27/22 00:12:52 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/27/22 00:12:52 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/27/22 00:12:53 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/27/22 00:12:53 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/27/22 00:12:53 - 0:00:01 - ============ Monolingual data (en)
INFO - 09/27/22 00:12:53 - 0:00:01 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/27/22 00:12:53 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/27/22 00:12:53 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/27/22 00:12:53 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/27/22 00:12:54 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/27/22 00:12:54 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/27/22 00:12:54 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/27/22 00:12:54 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/27/22 00:12:54 - 0:00:02 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/27/22 00:12:54 - 0:00:02 - Removed 0 empty sentences.

INFO - 09/27/22 00:12:54 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/27/22 00:12:54 - 0:00:02 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:12:54 - 0:00:02 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/27/22 00:12:54 - 0:00:02 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:12:55 - 0:00:03 - Removed 0 empty sentences.


INFO - 09/27/22 00:12:55 - 0:00:03 - ============ Data summary
INFO - 09/27/22 00:12:55 - 0:00:03 - Monolingual data   - valid -           de:      3000
INFO - 09/27/22 00:12:55 - 0:00:03 - Monolingual data   -  test -           de:      2999
INFO - 09/27/22 00:12:55 - 0:00:03 - Monolingual data   - valid -           en:      3000
INFO - 09/27/22 00:12:55 - 0:00:03 - Monolingual data   -  test -           en:      2999
INFO - 09/27/22 00:12:55 - 0:00:03 - Parallel data      - valid -        de-en:      3000
INFO - 09/27/22 00:12:55 - 0:00:03 - Parallel data      -  test -        de-en:      2999

INFO - 09/27/22 00:12:58 - 0:00:06 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt ...
INFO - 09/27/22 00:16:59 - 0:00:00 - ============ Initialized logger ============
INFO - 09/27/22 00:16:59 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 1
                                     beam_size: 1
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0' --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: 
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 1
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/27/22 00:16:59 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/27/22 00:16:59 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 1 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt,F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt' --word_mask_keep_rand '1,0,0'

INFO - 09/27/22 00:16:59 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/27/22 00:16:59 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/27/22 00:16:59 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/27/22 00:16:59 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/27/22 00:16:59 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/27/22 00:16:59 - 0:00:00 - ============ Monolingual data (en)
INFO - 09/27/22 00:16:59 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/27/22 00:16:59 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/27/22 00:16:59 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/27/22 00:16:59 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/27/22 00:16:59 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/27/22 00:16:59 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/27/22 00:16:59 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/27/22 00:16:59 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/27/22 00:17:00 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/27/22 00:17:00 - 0:00:01 - Removed 0 empty sentences.

INFO - 09/27/22 00:17:00 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/27/22 00:17:00 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:17:00 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/27/22 00:17:00 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:17:00 - 0:00:02 - Removed 0 empty sentences.


INFO - 09/27/22 00:17:00 - 0:00:02 - ============ Data summary
INFO - 09/27/22 00:17:00 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 09/27/22 00:17:00 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 09/27/22 00:17:00 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 09/27/22 00:17:00 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 09/27/22 00:17:00 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 09/27/22 00:17:00 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 09/27/22 00:17:04 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\XLMR\\xlmr.large\\model.pt ...
INFO - 09/27/22 00:19:49 - 0:00:00 - ============ Initialized logger ============
INFO - 09/27/22 00:19:49 - 0:00:00 - ae_steps: []
                                     asm: False
                                     attention_dropout: 0.1
                                     attention_setting: v1
                                     back_dataset: {}
                                     batch_size: 2
                                     beam_size: 4
                                     bmt_steps: []
                                     bptt: 128
                                     bt_src_langs: ['de', 'en']
                                     bt_steps: [('de', 'en', 'de'), ('en', 'de', 'en')]
                                     clip_grad_norm: 5
                                     clm_steps: []
                                     codes_path: 
                                     command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10 --exp_id "temp"
                                     context_size: 0
                                     cuda: False
                                     data_path: ./data/processed/de-en/
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: ./dumped/unsupMT_deen\temp
                                     early_stopping: False
                                     emb_dim: 1024
                                     encoder_only: False
                                     english_only: False
                                     epoch_size: 5
                                     eval_bleu: True
                                     eval_only: True
                                     exp_id: temp
                                     exp_name: unsupMT_deen
                                     fp16: False
                                     gelu_activation: True
                                     group_by_size: True
                                     id2lang: {0: 'de', 1: 'en'}
                                     is_master: True
                                     lambda_ae: 1
                                     lambda_bmt: 1
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mass: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lambda_pc: 1
                                     lambda_span: 10000
                                     lang2id: {'de': 0, 'en': 1}
                                     langs: ['de', 'en']
                                     length_penalty: 1
                                     lg_sampling_factor: -1
                                     lgs: de-en
                                     local_rank: 0
                                     mass_steps: []
                                     master_ip: None
                                     master_port: -1
                                     max_batch_size: 0
                                     max_epoch: 10
                                     max_len: 100
                                     max_vocab: -1
                                     min_count: 0
                                     min_len: 0
                                     mlm_steps: []
                                     mono_dataset: {'de': {'train': './data/processed/de-en/train.de.pth', 'valid': './data/processed/de-en/valid.de.pth', 'test': './data/processed/de-en/test.de.pth'}, 'en': {'train': './data/processed/de-en/train.en.pth', 'valid': './data/processed/de-en/valid.en.pth', 'test': './data/processed/de-en/test.en.pth'}}
                                     mt_steps: []
                                     multiLM: F:\\project\\UNMT\\LM\\XLMR
                                     multi_gpu: False
                                     multi_gpus: False
                                     n_dec_layers: 6
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     optimizer: adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001
                                     para_dataset: {('de', 'en'): {'valid': ('./data/processed/de-en/valid.de-en.de.pth', './data/processed/de-en/valid.de-en.en.pth'), 'test': ('./data/processed/de-en/test.de-en.de.pth', './data/processed/de-en/test.de-en.en.pth')}}
                                     pc_steps: []
                                     prefix: True
                                     reload_model: F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth
                                     sample_alpha: 0
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     stopping_criterion: _valid_de-en_mt_ppl,3
                                     temperature: None
                                     tokens_per_batch: 2000
                                     topk: 10
                                     validation_metrics: _valid_de-en_mt_ppl
                                     vocab_path: 
                                     word_blank: 0
                                     word_dropout: 0
                                     word_keep: 0.0
                                     word_mask: 1.0
                                     word_mask_keep_rand: 1,0,0
                                     word_mass: 0
                                     word_pred: 0.15
                                     word_rand: 0.0
                                     word_shuffle: 0
INFO - 09/27/22 00:19:49 - 0:00:00 - The experiment will be stored in ./dumped/unsupMT_deen\temp
                                     
INFO - 09/27/22 00:19:49 - 0:00:00 - Running command: python train.py --eval_only True --cuda False --prefix True --exp_name unsupMT_deen --exp_id temp --data_path './data/processed/de-en/' --lgs 'de-en' --bt_steps 'de-en-de,en-de-en' --encoder_only false --emb_dim 1024 --n_layers 6 --n_heads 8 --dropout '0.1' --attention_dropout '0.1' --gelu_activation true --tokens_per_batch 2000 --batch_size 2 --bptt 128 --optimizer 'adam_inverse_sqrt,beta1=0.9,beta2=0.98,lr=0.0001' --epoch_size 5 --max_epoch 10 --eval_bleu true --validation_metrics '_valid_de-en_mt_ppl' --stopping_criterion '_valid_de-en_mt_ppl,3' --reload_model 'F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth,F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth' --multiLM 'F:\\project\\UNMT\\LM\\XLMR' --word_mask_keep_rand '1,0,0' --beam_size 4 --topk 10

INFO - 09/27/22 00:19:49 - 0:00:00 - ============ Monolingual data (de)
INFO - 09/27/22 00:19:49 - 0:00:00 - Loading data from ./data/processed/de-en/valid.de.pth ...
INFO - 09/27/22 00:19:49 - 0:00:00 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.

INFO - 09/27/22 00:19:50 - 0:00:00 - Loading data from ./data/processed/de-en/test.de.pth ...
INFO - 09/27/22 00:19:50 - 0:00:00 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.

INFO - 09/27/22 00:19:50 - 0:00:00 - ============ Monolingual data (en)
INFO - 09/27/22 00:19:50 - 0:00:00 - Loading data from ./data/processed/de-en/valid.en.pth ...
INFO - 09/27/22 00:19:50 - 0:00:00 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.

INFO - 09/27/22 00:19:50 - 0:00:01 - Loading data from ./data/processed/de-en/test.en.pth ...
INFO - 09/27/22 00:19:50 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.


INFO - 09/27/22 00:19:50 - 0:00:01 - ============ Parallel data (de-en)
INFO - 09/27/22 00:19:50 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.de.pth ...
INFO - 09/27/22 00:19:50 - 0:00:01 - 74899 words (60408 unique) in 3000 sentences. 4 unknown words (3 unique) covering 0.01% of the data.
INFO - 09/27/22 00:19:50 - 0:00:01 - Loading data from ./data/processed/de-en/valid.de-en.en.pth ...
INFO - 09/27/22 00:19:50 - 0:00:01 - 70574 words (60408 unique) in 3000 sentences. 1 unknown words (1 unique) covering 0.00% of the data.
INFO - 09/27/22 00:19:51 - 0:00:01 - Removed 0 empty sentences.

INFO - 09/27/22 00:19:51 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.de.pth ...
INFO - 09/27/22 00:19:51 - 0:00:01 - 73662 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:19:51 - 0:00:01 - Loading data from ./data/processed/de-en/test.de-en.en.pth ...
INFO - 09/27/22 00:19:51 - 0:00:01 - 70156 words (60408 unique) in 2999 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 09/27/22 00:19:51 - 0:00:02 - Removed 0 empty sentences.


INFO - 09/27/22 00:19:51 - 0:00:02 - ============ Data summary
INFO - 09/27/22 00:19:51 - 0:00:02 - Monolingual data   - valid -           de:      3000
INFO - 09/27/22 00:19:51 - 0:00:02 - Monolingual data   -  test -           de:      2999
INFO - 09/27/22 00:19:51 - 0:00:02 - Monolingual data   - valid -           en:      3000
INFO - 09/27/22 00:19:51 - 0:00:02 - Monolingual data   -  test -           en:      2999
INFO - 09/27/22 00:19:51 - 0:00:02 - Parallel data      - valid -        de-en:      3000
INFO - 09/27/22 00:19:51 - 0:00:02 - Parallel data      -  test -        de-en:      2999

INFO - 09/27/22 00:19:54 - 0:00:05 - Reloading encoder from F:\\project\\UNMT\\LM\\CBD\\mass_ft_ende_1024.pth ...
